<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"junyiha.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="ç®€ä»‹ CUDA ä¸­å¸¸è§çš„å‡½æ•°">
<meta property="og:type" content="article">
<meta property="og:title" content="CUDA å¸¸è§å‡½æ•°">
<meta property="og:url" content="https://junyiha.github.io/2025/02/18/notebook/NVIDIA/CUDA/2025-02-18--%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/index.html">
<meta property="og:site_name" content="junyi&#39;s blog">
<meta property="og:description" content="ç®€ä»‹ CUDA ä¸­å¸¸è§çš„å‡½æ•°">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-18T01:00:00.000Z">
<meta property="article:modified_time" content="2025-04-28T08:08:39.414Z">
<meta property="article:author" content="zhang junyi">
<meta property="article:tag" content="CUDA">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://junyiha.github.io/2025/02/18/notebook/NVIDIA/CUDA/2025-02-18--%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>CUDA å¸¸è§å‡½æ•° | junyi's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">junyi's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">hahahahaha</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://junyiha.github.io/2025/02/18/notebook/NVIDIA/CUDA/2025-02-18--%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhang junyi">
      <meta itemprop="description" content="å·¥ä½œå­¦ä¹ ç¬”è®°">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="junyi's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CUDA å¸¸è§å‡½æ•°
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-02-18 09:00:00" itemprop="dateCreated datePublished" datetime="2025-02-18T09:00:00+08:00">2025-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-28 16:08:39" itemprop="dateModified" datetime="2025-04-28T16:08:39+08:00">2025-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NVIDIA/" itemprop="url" rel="index"><span itemprop="name">NVIDIA</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><ul>
<li>CUDA ä¸­å¸¸è§çš„å‡½æ•°</li>
</ul>
<span id="more"></span>

<h2 id="cudaSetDevice-å‡½æ•°-è¯¦è§£"><a href="#cudaSetDevice-å‡½æ•°-è¯¦è§£" class="headerlink" title="cudaSetDevice() å‡½æ•° è¯¦è§£"></a>cudaSetDevice() å‡½æ•° è¯¦è§£</h2><h3 id="cudaSetDevice-å‡½æ•°è¯¦è§£"><a href="#cudaSetDevice-å‡½æ•°è¯¦è§£" class="headerlink" title="cudaSetDevice() å‡½æ•°è¯¦è§£"></a><code>cudaSetDevice()</code> å‡½æ•°è¯¦è§£</h3><h4 id="1-ä½œç”¨"><a href="#1-ä½œç”¨" class="headerlink" title="1. ä½œç”¨"></a><strong>1. ä½œç”¨</strong></h4><p><code>cudaSetDevice(int device)</code> ç”¨äºè®¾ç½®å½“å‰ CPU çº¿ç¨‹è¦ä½¿ç”¨çš„ GPU è®¾å¤‡ã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¯èƒ½æœ‰å¤šä¸ª GPUï¼Œæ­¤å‡½æ•°å¯ä»¥è®©ç¨‹åºé€‰æ‹©ç‰¹å®šçš„ GPU è¿›è¡Œè®¡ç®—ã€‚</p>
<h4 id="2-è¯­æ³•"><a href="#2-è¯­æ³•" class="headerlink" title="2. è¯­æ³•"></a><strong>2. è¯­æ³•</strong></h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaSetDevice</span><span class="params">(<span class="type">int</span> device)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>device</code>ï¼šè¦é€‰æ‹©çš„ GPU è®¾å¤‡çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚</li>
<li>è¿”å›å€¼ï¼šè¿”å› <code>cudaError_t</code> ç±»å‹çš„é”™è¯¯ç ï¼Œè‹¥æˆåŠŸè¿”å› <code>cudaSuccess</code>ã€‚</li>
</ul>
<h4 id="3-ç›¸å…³è¯´æ˜"><a href="#3-ç›¸å…³è¯´æ˜" class="headerlink" title="3. ç›¸å…³è¯´æ˜"></a><strong>3. ç›¸å…³è¯´æ˜</strong></h4><ul>
<li>å¿…é¡»åœ¨è°ƒç”¨ä»»ä½• CUDA APIï¼ˆå¦‚ <code>cudaMalloc()</code>ã€<code>cudaMemcpy()</code>ï¼‰ä¹‹å‰è°ƒç”¨ <code>cudaSetDevice()</code>ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯æˆ–å½±å“æ€§èƒ½ã€‚</li>
<li>æ¯ä¸ª CPU çº¿ç¨‹åªèƒ½ç»‘å®šä¸€ä¸ª GPU è®¾å¤‡ï¼Œå› æ­¤ <code>cudaSetDevice()</code> ä»…å½±å“å½“å‰çº¿ç¨‹ã€‚</li>
<li>å¦‚æœæ²¡æœ‰è°ƒç”¨ <code>cudaSetDevice()</code>ï¼ŒCUDA è¿è¡Œæ—¶é»˜è®¤é€‰æ‹© <code>device 0</code>ã€‚</li>
<li>éœ€è¦ç¡®ä¿ <code>device</code> å€¼åœ¨å¯ç”¨çš„ GPU èŒƒå›´å†…ï¼ˆå¯ç”¨ <code>cudaGetDeviceCount()</code> è·å– GPU æ€»æ•°ï¼‰ã€‚</li>
</ul>
<h4 id="4-ä»£ç ç¤ºä¾‹"><a href="#4-ä»£ç ç¤ºä¾‹" class="headerlink" title="4. ä»£ç ç¤ºä¾‹"></a><strong>4. ä»£ç ç¤ºä¾‹</strong></h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> deviceCount;</span><br><span class="line">    <span class="built_in">cudaGetDeviceCount</span>(&amp;deviceCount);</span><br><span class="line">    <span class="keyword">if</span> (deviceCount == <span class="number">0</span>) &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;No CUDA devices available.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> deviceId = <span class="number">1</span>; <span class="comment">// å‡è®¾æƒ³ä½¿ç”¨ç¬¬ 1 å— GPU</span></span><br><span class="line">    <span class="keyword">if</span> (deviceId &gt;= deviceCount) &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;Invalid device ID.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cudaError_t err = <span class="built_in">cudaSetDevice</span>(deviceId);</span><br><span class="line">    <span class="keyword">if</span> (err != cudaSuccess) &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;cudaSetDevice failed: &quot;</span> &lt;&lt; <span class="built_in">cudaGetErrorString</span>(err) &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Using GPU &quot;</span> &lt;&lt; deviceId &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-è·å–å½“å‰è®¾å¤‡"><a href="#5-è·å–å½“å‰è®¾å¤‡" class="headerlink" title="5. è·å–å½“å‰è®¾å¤‡"></a><strong>5. è·å–å½“å‰è®¾å¤‡</strong></h4><p>å¯ä»¥ä½¿ç”¨ <code>cudaGetDevice()</code> è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„ GPUï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> currentDevice;</span><br><span class="line"><span class="built_in">cudaGetDevice</span>(&amp;currentDevice);</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Current device: &quot;</span> &lt;&lt; currentDevice &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure>

<h4 id="6-çº¿ç¨‹ä¸è®¾å¤‡çš„å…³ç³»"><a href="#6-çº¿ç¨‹ä¸è®¾å¤‡çš„å…³ç³»" class="headerlink" title="6. çº¿ç¨‹ä¸è®¾å¤‡çš„å…³ç³»"></a><strong>6. çº¿ç¨‹ä¸è®¾å¤‡çš„å…³ç³»</strong></h4><ul>
<li>åœ¨ <strong>å•çº¿ç¨‹ç¨‹åº</strong> ä¸­ï¼Œæ¯ä¸ª CPU çº¿ç¨‹åªèƒ½ä½¿ç”¨ä¸€ä¸ª GPUã€‚</li>
<li>åœ¨ <strong>å¤šçº¿ç¨‹ç¨‹åº</strong> ä¸­ï¼Œä¸åŒçš„ CPU çº¿ç¨‹å¯ä»¥ç»‘å®šåˆ°ä¸åŒçš„ GPU ä»¥å¹¶è¡Œè®¡ç®—ï¼Œä½†ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½åŒæ—¶ä½¿ç”¨å¤šä¸ª GPUã€‚</li>
</ul>
<h4 id="7-å¯èƒ½çš„é”™è¯¯"><a href="#7-å¯èƒ½çš„é”™è¯¯" class="headerlink" title="7. å¯èƒ½çš„é”™è¯¯"></a><strong>7. å¯èƒ½çš„é”™è¯¯</strong></h4><table>
<thead>
<tr>
<th>é”™è¯¯ä»£ç </th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>cudaErrorInvalidDevice</code></td>
<td><code>device</code> å·è¶…å‡º GPU æ•°é‡èŒƒå›´</td>
</tr>
<tr>
<td><code>cudaErrorSetOnActiveProcess</code></td>
<td>å½“å‰è¿›ç¨‹å·²ç»ä½¿ç”¨äº†å¦ä¸€ä¸ª GPUï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼‰</td>
</tr>
</tbody></table>
<h4 id="8-ç»“åˆ-cudaGetDeviceCount"><a href="#8-ç»“åˆ-cudaGetDeviceCount" class="headerlink" title="8. ç»“åˆ cudaGetDeviceCount()"></a><strong>8. ç»“åˆ <code>cudaGetDeviceCount()</code></strong></h4><p>åœ¨è°ƒç”¨ <code>cudaSetDevice()</code> ä¹‹å‰ï¼Œå»ºè®®ä½¿ç”¨ <code>cudaGetDeviceCount()</code> ç¡®ä¿ <code>device</code> å€¼åˆæ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> deviceCount;</span><br><span class="line"><span class="built_in">cudaGetDeviceCount</span>(&amp;deviceCount);</span><br><span class="line"><span class="keyword">if</span> (deviceCount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(<span class="number">0</span>); <span class="comment">// é€‰æ‹©ç¬¬ä¸€ä¸ª GPU</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9. æ€»ç»“"></a><strong>9. æ€»ç»“</strong></h4><ul>
<li><code>cudaSetDevice()</code> ç”¨äºé€‰æ‹© GPUï¼Œå¿…é¡»åœ¨ CUDA ç›¸å…³ API è°ƒç”¨å‰ä½¿ç”¨ã€‚</li>
<li>ä»…å¯¹å½“å‰ CPU çº¿ç¨‹ç”Ÿæ•ˆã€‚</li>
<li>åœ¨å¤š GPU ç¯å¢ƒä¸‹ï¼Œå¯ç»“åˆ <code>cudaGetDeviceCount()</code> å’Œ <code>cudaGetDevice()</code> ç¡®ä¿é€‰æ‹©æœ‰æ•ˆè®¾å¤‡ã€‚</li>
</ul>
<p>è¿™æ ·å¯ä»¥æœ‰æ•ˆç®¡ç†å¤š GPU è®¡ç®—èµ„æºï¼Œæé«˜ CUDA ç¨‹åºçš„çµæ´»æ€§å’Œæ€§èƒ½ã€‚ ğŸš€</p>
<h2 id="cudaMalloc-å‡½æ•°-è¯¦è§£"><a href="#cudaMalloc-å‡½æ•°-è¯¦è§£" class="headerlink" title="cudaMalloc() å‡½æ•° è¯¦è§£"></a>cudaMalloc() å‡½æ•° è¯¦è§£</h2><h1 id="cudaMalloc-å‡½æ•°è¯¦è§£"><a href="#cudaMalloc-å‡½æ•°è¯¦è§£" class="headerlink" title="cudaMalloc() å‡½æ•°è¯¦è§£"></a><strong><code>cudaMalloc()</code> å‡½æ•°è¯¦è§£</strong></h1><h2 id="1-ä½œç”¨-1"><a href="#1-ä½œç”¨-1" class="headerlink" title="1. ä½œç”¨"></a><strong>1. ä½œç”¨</strong></h2><p><code>cudaMalloc()</code> ç”¨äºåœ¨ GPU è®¾å¤‡ï¼ˆDeviceï¼‰ä¸Šåˆ†é…å…¨å±€å†…å­˜ï¼ˆGlobal Memoryï¼‰ã€‚è¿™æ˜¯ CUDA ä¸­æœ€åŸºç¡€çš„å†…å­˜ç®¡ç†å‡½æ•°ä¹‹ä¸€ã€‚</p>
<hr>
<h2 id="2-è¯­æ³•-1"><a href="#2-è¯­æ³•-1" class="headerlink" title="2. è¯­æ³•"></a><strong>2. è¯­æ³•</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMalloc</span><span class="params">(<span class="type">void</span>** devPtr, <span class="type">size_t</span> size)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a><strong>å‚æ•°</strong></h3><ul>
<li><code>devPtr</code>ï¼šæŒ‡å‘å­˜å‚¨è®¾å¤‡å†…å­˜åœ°å€çš„æŒ‡é’ˆå˜é‡ï¼ˆå³æŒ‡å‘ <code>void*</code> çš„æŒ‡é’ˆï¼‰ã€‚</li>
<li><code>size</code>ï¼šè¦åˆ†é…çš„å†…å­˜å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li>
</ul>
<h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a><strong>è¿”å›å€¼</strong></h3><ul>
<li><strong><code>cudaSuccess</code>ï¼ˆ0ï¼‰</strong>ï¼šåˆ†é…æˆåŠŸã€‚</li>
<li><strong>å…¶ä»–é”™è¯¯ç </strong>ï¼ˆå¦‚ <code>cudaErrorMemoryAllocation</code>ï¼‰ï¼šåˆ†é…å¤±è´¥ã€‚</li>
</ul>
<hr>
<h2 id="3-ä½¿ç”¨ç¤ºä¾‹"><a href="#3-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="3. ä½¿ç”¨ç¤ºä¾‹"></a><strong>3. ä½¿ç”¨ç¤ºä¾‹</strong></h2><h3 id="1-åœ¨-GPU-è®¾å¤‡ä¸Šåˆ†é…å†…å­˜"><a href="#1-åœ¨-GPU-è®¾å¤‡ä¸Šåˆ†é…å†…å­˜" class="headerlink" title="(1) åœ¨ GPU è®¾å¤‡ä¸Šåˆ†é…å†…å­˜"></a><strong>(1) åœ¨ GPU è®¾å¤‡ä¸Šåˆ†é…å†…å­˜</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span>* d_ptr;  <span class="comment">// è®¾å¤‡æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">size_t</span> size = <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>);  <span class="comment">// åˆ†é… 100 ä¸ª int</span></span><br><span class="line"></span><br><span class="line">    cudaError_t err = <span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_ptr, size);</span><br><span class="line">    <span class="keyword">if</span> (err != cudaSuccess) &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;cudaMalloc failed: &quot;</span> &lt;&lt; <span class="built_in">cudaGetErrorString</span>(err) &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Memory allocated on GPU.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾è®¾å¤‡å†…å­˜</span></span><br><span class="line">    <span class="built_in">cudaFree</span>(d_ptr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-ç›¸å…³æ³¨æ„äº‹é¡¹"><a href="#4-ç›¸å…³æ³¨æ„äº‹é¡¹" class="headerlink" title="4. ç›¸å…³æ³¨æ„äº‹é¡¹"></a><strong>4. ç›¸å…³æ³¨æ„äº‹é¡¹</strong></h2><h3 id="1-è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥åœ¨ä¸»æœºï¼ˆCPUï¼‰ç«¯è®¿é—®"><a href="#1-è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥åœ¨ä¸»æœºï¼ˆCPUï¼‰ç«¯è®¿é—®" class="headerlink" title="(1) è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥åœ¨ä¸»æœºï¼ˆCPUï¼‰ç«¯è®¿é—®"></a><strong>(1) è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥åœ¨ä¸»æœºï¼ˆCPUï¼‰ç«¯è®¿é—®</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>* d_ptr;</span><br><span class="line"><span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_ptr, <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">std::cout &lt;&lt; *d_ptr &lt;&lt; std::endl;  <span class="comment">// âŒ é”™è¯¯ï¼è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥è§£å¼•ç”¨</span></span><br></pre></td></tr></table></figure>
<p><strong>æ­£ç¡®åšæ³•</strong>ï¼šä½¿ç”¨ <code>cudaMemcpy()</code> å°†æ•°æ®æ‹·è´åˆ°ä¸»æœºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> h_val;</span><br><span class="line"><span class="built_in">cudaMemcpy</span>(&amp;h_val, d_ptr, <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyDeviceToHost);</span><br><span class="line">std::cout &lt;&lt; h_val &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-è®¾å¤‡å†…å­˜éœ€è¦æ‰‹åŠ¨é‡Šæ”¾"><a href="#2-è®¾å¤‡å†…å­˜éœ€è¦æ‰‹åŠ¨é‡Šæ”¾" class="headerlink" title="(2) è®¾å¤‡å†…å­˜éœ€è¦æ‰‹åŠ¨é‡Šæ”¾"></a><strong>(2) è®¾å¤‡å†…å­˜éœ€è¦æ‰‹åŠ¨é‡Šæ”¾</strong></h3><ul>
<li>ä½¿ç”¨ <code>cudaFree()</code> é‡Šæ”¾å†…å­˜ï¼š<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaFree</span>(d_ptr);</span><br></pre></td></tr></table></figure></li>
<li>å¦‚æœå¿˜è®°é‡Šæ”¾ï¼Œä¼šå¯¼è‡´ <strong>æ˜¾å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰</strong>ã€‚</li>
</ul>
<hr>
<h3 id="3-æ£€æŸ¥-cudaMalloc-æ˜¯å¦æˆåŠŸ"><a href="#3-æ£€æŸ¥-cudaMalloc-æ˜¯å¦æˆåŠŸ" class="headerlink" title="(3) æ£€æŸ¥ cudaMalloc() æ˜¯å¦æˆåŠŸ"></a><strong>(3) æ£€æŸ¥ <code>cudaMalloc()</code> æ˜¯å¦æˆåŠŸ</strong></h3><ul>
<li><strong>å¯èƒ½çš„é”™è¯¯</strong><ul>
<li><code>cudaErrorMemoryAllocation</code>ï¼šæ˜¾å­˜ä¸è¶³</li>
<li><code>cudaErrorInvalidValue</code>ï¼š<code>size</code> ä¸º 0</li>
<li><code>cudaErrorInvalidDevicePointer</code>ï¼šä¼ å…¥çš„æŒ‡é’ˆéæ³•</li>
</ul>
</li>
<li><strong>å»ºè®®ï¼šå§‹ç»ˆæ£€æŸ¥è¿”å›å€¼</strong><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_ptr, size) != cudaSuccess) &#123;</span><br><span class="line">    std::cerr &lt;&lt; <span class="string">&quot;Memory allocation failed!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="4-è®¡ç®—è®¾å¤‡å†…å­˜çš„ä½¿ç”¨æƒ…å†µ"><a href="#4-è®¡ç®—è®¾å¤‡å†…å­˜çš„ä½¿ç”¨æƒ…å†µ" class="headerlink" title="(4) è®¡ç®—è®¾å¤‡å†…å­˜çš„ä½¿ç”¨æƒ…å†µ"></a><strong>(4) è®¡ç®—è®¾å¤‡å†…å­˜çš„ä½¿ç”¨æƒ…å†µ</strong></h3><ul>
<li><code>cudaMemGetInfo()</code> å¯ç”¨äºæŸ¥è¯¢ GPU å‰©ä½™å†…å­˜ï¼š<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> freeMem, totalMem;</span><br><span class="line"><span class="built_in">cudaMemGetInfo</span>(&amp;freeMem, &amp;totalMem);</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Free memory: &quot;</span> &lt;&lt; freeMem / (<span class="number">1024</span> * <span class="number">1024</span>) &lt;&lt; <span class="string">&quot; MB, &quot;</span></span><br><span class="line">          &lt;&lt; <span class="string">&quot;Total memory: &quot;</span> &lt;&lt; totalMem / (<span class="number">1024</span> * <span class="number">1024</span>) &lt;&lt; <span class="string">&quot; MB&quot;</span> &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="5-å¤š-GPU-ç¯å¢ƒ"><a href="#5-å¤š-GPU-ç¯å¢ƒ" class="headerlink" title="(5) å¤š GPU ç¯å¢ƒ"></a><strong>(5) å¤š GPU ç¯å¢ƒ</strong></h3><ul>
<li><code>cudaMalloc()</code> ä»…åœ¨å½“å‰è®¾å¤‡ä¸Šåˆ†é…å†…å­˜ã€‚</li>
<li>è‹¥ä½¿ç”¨å¤š GPUï¼Œå¯å…ˆè°ƒç”¨ <code>cudaSetDevice(deviceId)</code> åˆ‡æ¢ GPUï¼š<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaSetDevice</span>(<span class="number">1</span>);  <span class="comment">// é€‰æ‹© GPU 1</span></span><br><span class="line"><span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_ptr, size);</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="5-cudaMalloc-ä¸å…¶ä»–-CUDA-å†…å­˜ç®¡ç†å‡½æ•°çš„æ¯”è¾ƒ"><a href="#5-cudaMalloc-ä¸å…¶ä»–-CUDA-å†…å­˜ç®¡ç†å‡½æ•°çš„æ¯”è¾ƒ" class="headerlink" title="5. cudaMalloc() ä¸å…¶ä»– CUDA å†…å­˜ç®¡ç†å‡½æ•°çš„æ¯”è¾ƒ"></a><strong>5. <code>cudaMalloc()</code> ä¸å…¶ä»– CUDA å†…å­˜ç®¡ç†å‡½æ•°çš„æ¯”è¾ƒ</strong></h2><table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>ä½œç”¨</th>
<th>é€‚ç”¨åœºæ™¯</th>
<th>é‡Šæ”¾æ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td><code>cudaMalloc()</code></td>
<td>è®¾å¤‡å…¨å±€å†…å­˜åˆ†é…</td>
<td>GPU è®¡ç®—æ•°æ®å­˜å‚¨</td>
<td><code>cudaFree()</code></td>
</tr>
<tr>
<td><code>cudaMallocHost()</code></td>
<td>ä¸»æœºé¡µé”å®šå†…å­˜ï¼ˆå¯ç”¨äºå¼‚æ­¥æ‹·è´ï¼‰</td>
<td><code>cudaMemcpyAsync()</code></td>
<td><code>cudaFreeHost()</code></td>
</tr>
<tr>
<td><code>cudaMallocManaged()</code></td>
<td>ç»Ÿä¸€å†…å­˜ï¼ˆä¸»æœºå’Œè®¾å¤‡å…±äº«ï¼‰</td>
<td>ç»Ÿä¸€å†…å­˜ç¼–ç¨‹</td>
<td><code>cudaFree()</code></td>
</tr>
<tr>
<td><code>cudaMallocPitch()</code></td>
<td>2D æ•°ç»„åˆ†é…ï¼Œä¼˜åŒ–å¯¹é½</td>
<td>å¤„ç†å›¾åƒç­‰ 2D æ•°æ®</td>
<td><code>cudaFree()</code></td>
</tr>
</tbody></table>
<hr>
<h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a><strong>6. æ€»ç»“</strong></h2><ul>
<li><code>cudaMalloc()</code> åœ¨ GPU ä¸Šåˆ†é…å…¨å±€å†…å­˜ï¼Œè¿”å›è®¾å¤‡æŒ‡é’ˆã€‚</li>
<li>ä¸èƒ½ç›´æ¥è®¿é—®è®¾å¤‡æŒ‡é’ˆï¼Œéœ€è¦ä½¿ç”¨ <code>cudaMemcpy()</code> è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</li>
<li>éœ€è¦æ‰‹åŠ¨é‡Šæ”¾ <code>cudaFree()</code>ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ˜¾å­˜æ³„æ¼ã€‚</li>
<li>åœ¨å¤š GPU ç¯å¢ƒä¸‹ï¼Œåº”å…ˆè°ƒç”¨ <code>cudaSetDevice()</code> é€‰æ‹©ç›®æ ‡ GPUã€‚</li>
</ul>
<p>åˆç†ä½¿ç”¨ <code>cudaMalloc()</code> è¿›è¡Œæ˜¾å­˜ç®¡ç†ï¼Œå¯ä»¥æé«˜ CUDA ç¨‹åºçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚ ğŸš€</p>
<h2 id="cudaStreamCreate-å‡½æ•°-è¯¦è§£"><a href="#cudaStreamCreate-å‡½æ•°-è¯¦è§£" class="headerlink" title="cudaStreamCreate() å‡½æ•° è¯¦è§£"></a>cudaStreamCreate() å‡½æ•° è¯¦è§£</h2><h1 id="cudaStreamCreate-å‡½æ•°è¯¦è§£"><a href="#cudaStreamCreate-å‡½æ•°è¯¦è§£" class="headerlink" title="cudaStreamCreate() å‡½æ•°è¯¦è§£"></a><strong><code>cudaStreamCreate()</code> å‡½æ•°è¯¦è§£</strong></h1><h2 id="1-ä½œç”¨-2"><a href="#1-ä½œç”¨-2" class="headerlink" title="1. ä½œç”¨"></a><strong>1. ä½œç”¨</strong></h2><p><code>cudaStreamCreate()</code> ç”¨äºåˆ›å»º CUDA <strong>æµï¼ˆStreamï¼‰</strong>ï¼Œæµæ˜¯ä¸€ç§å¼‚æ­¥æ‰§è¡Œçš„é˜Ÿåˆ—ï¼Œå¯ä»¥åœ¨åŒä¸€ GPU ä¸ŠåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå®ç° <strong>å¹¶è¡Œè®¡ç®—</strong> å’Œ <strong>å¼‚æ­¥æ‰§è¡Œ</strong>ã€‚</p>
<hr>
<h2 id="2-è¯­æ³•-2"><a href="#2-è¯­æ³•-2" class="headerlink" title="2. è¯­æ³•"></a><strong>2. è¯­æ³•</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamCreate</span><span class="params">(cudaStream_t* pStream)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•°"></a><strong>å‚æ•°</strong></h3><ul>
<li><code>pStream</code>ï¼šæŒ‡å‘ <code>cudaStream_t</code> ç±»å‹çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨åˆ›å»ºçš„æµçš„å¥æŸ„ã€‚</li>
</ul>
<h3 id="è¿”å›å€¼-1"><a href="#è¿”å›å€¼-1" class="headerlink" title="è¿”å›å€¼"></a><strong>è¿”å›å€¼</strong></h3><ul>
<li><code>cudaSuccess</code>ï¼šæµåˆ›å»ºæˆåŠŸã€‚</li>
<li>å…¶ä»– <code>cudaError_t</code> é”™è¯¯ç ï¼šåˆ›å»ºå¤±è´¥ï¼Œä¾‹å¦‚ <strong>å†…å­˜ä¸è¶³</strong> æˆ– <strong>CUDA ä¸Šä¸‹æ–‡é—®é¢˜</strong>ã€‚</li>
</ul>
<hr>
<h2 id="3-ä½¿ç”¨ç¤ºä¾‹-1"><a href="#3-ä½¿ç”¨ç¤ºä¾‹-1" class="headerlink" title="3. ä½¿ç”¨ç¤ºä¾‹"></a><strong>3. ä½¿ç”¨ç¤ºä¾‹</strong></h2><h3 id="1-åˆ›å»ºå¹¶ä½¿ç”¨-CUDA-æµ"><a href="#1-åˆ›å»ºå¹¶ä½¿ç”¨-CUDA-æµ" class="headerlink" title="(1) åˆ›å»ºå¹¶ä½¿ç”¨ CUDA æµ"></a><strong>(1) åˆ›å»ºå¹¶ä½¿ç”¨ CUDA æµ</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cudaStream_t stream;</span><br><span class="line">    cudaError_t err = <span class="built_in">cudaStreamCreate</span>(&amp;stream);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (err != cudaSuccess) &#123;</span><br><span class="line">        std::cerr &lt;&lt; <span class="string">&quot;cudaStreamCreate failed: &quot;</span> &lt;&lt; <span class="built_in">cudaGetErrorString</span>(err) &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;CUDA Stream created successfully!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æµè¿›è¡Œå¼‚æ­¥è®¡ç®—ï¼ˆç¤ºä¾‹ä»£ç ç•¥ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾æµ</span></span><br><span class="line">    <span class="built_in">cudaStreamDestroy</span>(stream);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-ç›¸å…³å‡½æ•°"><a href="#4-ç›¸å…³å‡½æ•°" class="headerlink" title="4. ç›¸å…³å‡½æ•°"></a><strong>4. ç›¸å…³å‡½æ•°</strong></h2><h3 id="1-cudaStreamDestroy-é”€æ¯-CUDA-æµ"><a href="#1-cudaStreamDestroy-é”€æ¯-CUDA-æµ" class="headerlink" title="(1) cudaStreamDestroy() - é”€æ¯ CUDA æµ"></a><strong>(1) <code>cudaStreamDestroy()</code> - é”€æ¯ CUDA æµ</strong></h3><p>æ¯ä¸ªåˆ›å»ºçš„ CUDA æµåœ¨ä½¿ç”¨ååº”å½“é‡Šæ”¾ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaStreamDestroy</span>(stream);</span><br></pre></td></tr></table></figure>

<h3 id="2-cudaMemcpyAsync-å¼‚æ­¥æ‹·è´"><a href="#2-cudaMemcpyAsync-å¼‚æ­¥æ‹·è´" class="headerlink" title="(2) cudaMemcpyAsync() - å¼‚æ­¥æ‹·è´"></a><strong>(2) <code>cudaMemcpyAsync()</code> - å¼‚æ­¥æ‹·è´</strong></h3><p>æµå¯ä»¥ä¸ <code>cudaMemcpyAsync()</code> ç»“åˆï¼Œå®ç° <strong>å¼‚æ­¥æ•°æ®æ‹·è´</strong>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>* d_data;</span><br><span class="line"><span class="type">int</span> h_data[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_data, <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyAsync</span>(d_data, h_data, <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyHostToDevice, stream);</span><br></pre></td></tr></table></figure>

<h3 id="3-cudaStreamSynchronize-ç­‰å¾…æµå®Œæˆ"><a href="#3-cudaStreamSynchronize-ç­‰å¾…æµå®Œæˆ" class="headerlink" title="(3) cudaStreamSynchronize() - ç­‰å¾…æµå®Œæˆ"></a><strong>(3) <code>cudaStreamSynchronize()</code> - ç­‰å¾…æµå®Œæˆ</strong></h3><p>ä½¿ç”¨ <code>cudaStreamSynchronize()</code> å¯ä»¥ç­‰å¾…ç‰¹å®šæµä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaStreamSynchronize</span>(stream);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-CUDA-æµçš„ç‰¹ç‚¹"><a href="#5-CUDA-æµçš„ç‰¹ç‚¹" class="headerlink" title="5. CUDA æµçš„ç‰¹ç‚¹"></a><strong>5. CUDA æµçš„ç‰¹ç‚¹</strong></h2><h3 id="1-é»˜è®¤æµï¼ˆcudaStream-t-0-ï¼‰"><a href="#1-é»˜è®¤æµï¼ˆcudaStream-t-0-ï¼‰" class="headerlink" title="(1) é»˜è®¤æµï¼ˆcudaStream_t(0)ï¼‰"></a><strong>(1) é»˜è®¤æµï¼ˆ<code>cudaStream_t(0)</code>ï¼‰</strong></h3><ul>
<li>å¦‚æœ <strong>ä¸æŒ‡å®šæµ</strong>ï¼ŒCUDA å†…æ ¸å’Œ <code>cudaMemcpy()</code> è¿è¡Œåœ¨ <strong>é»˜è®¤æµï¼ˆé»˜è®¤é˜Ÿåˆ—ï¼‰</strong> ä¸­ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œï¼š<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaMemcpy</span>(d_data, h_data, <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">kernel&lt;&lt;&lt;grid, block&gt;&gt;&gt;(d_data);</span><br><span class="line"><span class="built_in">cudaMemcpy</span>(h_data, d_data, <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyDeviceToHost);</span><br></pre></td></tr></table></figure></li>
<li>è¿™äº›æ“ä½œä¼š <strong>æŒ‰é¡ºåºæ‰§è¡Œ</strong>ï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å¾…ä¸Šä¸€ä¸ªä»»åŠ¡å®Œæˆã€‚</li>
</ul>
<h3 id="2-ç”¨æˆ·å®šä¹‰æµï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰"><a href="#2-ç”¨æˆ·å®šä¹‰æµï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰" class="headerlink" title="(2) ç”¨æˆ·å®šä¹‰æµï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰"></a><strong>(2) ç”¨æˆ·å®šä¹‰æµï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰</strong></h3><ul>
<li>ä½¿ç”¨ <code>cudaStreamCreate()</code> åˆ›å»º <strong>å¤šä¸ªæµ</strong>ï¼Œå¯åœ¨åŒä¸€ GPU è®¾å¤‡ä¸ŠåŒæ—¶æ‰§è¡Œ <strong>å¤šä¸ªä»»åŠ¡</strong>ï¼š<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cudaStream_t stream1, stream2;</span><br><span class="line"><span class="built_in">cudaStreamCreate</span>(&amp;stream1);</span><br><span class="line"><span class="built_in">cudaStreamCreate</span>(&amp;stream2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ stream1 ä¸­æ‰§è¡Œå†…å­˜æ‹·è´</span></span><br><span class="line"><span class="built_in">cudaMemcpyAsync</span>(d_data1, h_data1, size, cudaMemcpyHostToDevice, stream1);</span><br><span class="line"><span class="comment">// åœ¨ stream2 ä¸­æ‰§è¡Œä¸åŒçš„ä»»åŠ¡</span></span><br><span class="line"><span class="built_in">cudaMemcpyAsync</span>(d_data2, h_data2, size, cudaMemcpyHostToDevice, stream2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾…ä¸¤ä¸ªæµå®Œæˆ</span></span><br><span class="line"><span class="built_in">cudaStreamSynchronize</span>(stream1);</span><br><span class="line"><span class="built_in">cudaStreamSynchronize</span>(stream2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡Šæ”¾æµ</span></span><br><span class="line"><span class="built_in">cudaStreamDestroy</span>(stream1);</span><br><span class="line"><span class="built_in">cudaStreamDestroy</span>(stream2);</span><br></pre></td></tr></table></figure>
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<strong>æ•°æ®æ‹·è´å’Œè®¡ç®—å¯ä»¥å¹¶è¡Œæ‰§è¡Œ</strong>ï¼Œæé«˜ GPU åˆ©ç”¨ç‡ã€‚</li>
</ul>
<hr>
<h2 id="6-ä½¿ç”¨å¤šä¸ª-CUDA-æµçš„åº”ç”¨åœºæ™¯"><a href="#6-ä½¿ç”¨å¤šä¸ª-CUDA-æµçš„åº”ç”¨åœºæ™¯" class="headerlink" title="6. ä½¿ç”¨å¤šä¸ª CUDA æµçš„åº”ç”¨åœºæ™¯"></a><strong>6. ä½¿ç”¨å¤šä¸ª CUDA æµçš„åº”ç”¨åœºæ™¯</strong></h2><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ•°æ®æ‹·è´ä¸è®¡ç®—é‡å </strong></td>
<td><code>cudaMemcpyAsync()</code> å’Œ Kernel åœ¨ä¸åŒæµä¸­æ‰§è¡Œï¼Œæé«˜æ•ˆç‡</td>
</tr>
<tr>
<td><strong>å¤š Kernel å¹¶è¡Œæ‰§è¡Œ</strong></td>
<td>å¤šä¸ª Kernel ä»»åŠ¡æ”¾å…¥ä¸åŒæµï¼Œæé«˜è®¡ç®—ååé‡</td>
</tr>
<tr>
<td><strong>å¤šçº¿ç¨‹ä»»åŠ¡è°ƒåº¦</strong></td>
<td>åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ç®¡ç†ä¸€ä¸ª CUDA æµ</td>
</tr>
</tbody></table>
<hr>
<h2 id="7-cudaStreamCreate-å¯èƒ½çš„é”™è¯¯"><a href="#7-cudaStreamCreate-å¯èƒ½çš„é”™è¯¯" class="headerlink" title="7. cudaStreamCreate() å¯èƒ½çš„é”™è¯¯"></a><strong>7. <code>cudaStreamCreate()</code> å¯èƒ½çš„é”™è¯¯</strong></h2><table>
<thead>
<tr>
<th>é”™è¯¯ç </th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>cudaErrorInvalidValue</code></td>
<td><code>pStream</code> ä¸ºç©ºæŒ‡é’ˆ</td>
</tr>
<tr>
<td><code>cudaErrorMemoryAllocation</code></td>
<td>å†…å­˜ä¸è¶³ï¼Œæ— æ³•åˆ›å»ºæµ</td>
</tr>
<tr>
<td><code>cudaErrorInitializationError</code></td>
<td>CUDA è¿è¡Œæ—¶æœªæ­£ç¡®åˆå§‹åŒ–</td>
</tr>
</tbody></table>
<hr>
<h2 id="8-æ€»ç»“"><a href="#8-æ€»ç»“" class="headerlink" title="8. æ€»ç»“"></a><strong>8. æ€»ç»“</strong></h2><ul>
<li><code>cudaStreamCreate()</code> åˆ›å»º <strong>CUDA æµ</strong>ï¼Œç”¨äºå¼‚æ­¥æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>ä»»åŠ¡å¯ä½¿ç”¨ <code>cudaMemcpyAsync()</code> æˆ– <code>cudaLaunchKernel()</code> æäº¤åˆ°ç‰¹å®šæµã€‚</li>
<li>ä½¿ç”¨ <code>cudaStreamSynchronize()</code> ç­‰å¾…æµå®Œæˆï¼Œä½¿ç”¨ <code>cudaStreamDestroy()</code> é‡Šæ”¾èµ„æºã€‚</li>
<li>é€‚ç”¨äº <strong>æ•°æ®ä¼ è¾“ä¸è®¡ç®—é‡å ã€Kernel å¹¶è¡Œæ‰§è¡Œã€å¤šçº¿ç¨‹ä»»åŠ¡è°ƒåº¦</strong> ç­‰åœºæ™¯ã€‚</li>
</ul>
<p>åˆç†ä½¿ç”¨ CUDA æµï¼Œå¯ä»¥ <strong>æå‡ GPU å¹¶è¡Œè®¡ç®—æ•ˆç‡</strong>ï¼ŒåŠ é€Ÿæ·±åº¦å­¦ä¹ ã€ç§‘å­¦è®¡ç®—ç­‰åº”ç”¨ï¼ğŸš€</p>
<h2 id="cudaMemcpyAsync-å‡½æ•°-è¯¦è§£"><a href="#cudaMemcpyAsync-å‡½æ•°-è¯¦è§£" class="headerlink" title="cudaMemcpyAsync() å‡½æ•° è¯¦è§£"></a>cudaMemcpyAsync() å‡½æ•° è¯¦è§£</h2><h1 id="cudaMemcpyAsync-å‡½æ•°è¯¦è§£"><a href="#cudaMemcpyAsync-å‡½æ•°è¯¦è§£" class="headerlink" title="cudaMemcpyAsync() å‡½æ•°è¯¦è§£"></a><strong><code>cudaMemcpyAsync()</code> å‡½æ•°è¯¦è§£</strong></h1><h2 id="1-ä½œç”¨-3"><a href="#1-ä½œç”¨-3" class="headerlink" title="1. ä½œç”¨"></a><strong>1. ä½œç”¨</strong></h2><p><code>cudaMemcpyAsync()</code> ç”¨äºåœ¨ <strong>ä¸»æœºï¼ˆHostï¼‰</strong> å’Œ <strong>è®¾å¤‡ï¼ˆDeviceï¼‰</strong> ä¹‹é—´è¿›è¡Œ <strong>å¼‚æ­¥</strong> æ•°æ®æ‹·è´ï¼Œä¸ <code>cudaMemcpy()</code> ä¸åŒï¼Œå®ƒä¸ä¼šé˜»å¡ CPUï¼Œè€Œæ˜¯å°†æ‹·è´ä»»åŠ¡æ”¾å…¥æŒ‡å®šçš„ <strong>CUDA æµï¼ˆStreamï¼‰</strong> ä¸­ï¼Œä»è€Œå®ç° <strong>æ•°æ®ä¼ è¾“ä¸è®¡ç®—çš„é‡å </strong>ï¼Œæé«˜ GPU è®¡ç®—æ•ˆç‡ã€‚</p>
<hr>
<h2 id="2-è¯­æ³•-3"><a href="#2-è¯­æ³•-3" class="headerlink" title="2. è¯­æ³•"></a><strong>2. è¯­æ³•</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpyAsync</span><span class="params">(<span class="type">void</span>* dst, <span class="type">const</span> <span class="type">void</span>* src, <span class="type">size_t</span> count, cudaMemcpyKind kind, cudaStream_t stream)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="å‚æ•°-2"><a href="#å‚æ•°-2" class="headerlink" title="å‚æ•°"></a><strong>å‚æ•°</strong></h3><ul>
<li><code>dst</code>ï¼šç›®æ ‡åœ°å€ï¼ˆå¯ä»¥æ˜¯ä¸»æœºæˆ–è®¾å¤‡å†…å­˜ï¼‰ã€‚</li>
<li><code>src</code>ï¼šæºåœ°å€ï¼ˆå¯ä»¥æ˜¯ä¸»æœºæˆ–è®¾å¤‡å†…å­˜ï¼‰ã€‚</li>
<li><code>count</code>ï¼šæ‹·è´çš„æ•°æ®å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li>
<li><code>kind</code>ï¼šæ•°æ®æ‹·è´çš„æ–¹å‘ï¼Œ<code>cudaMemcpyKind</code> æšä¸¾å€¼ï¼š<ul>
<li><code>cudaMemcpyHostToDevice</code>ï¼ˆHâ†’Dï¼‰ï¼šä»ä¸»æœºæ‹·è´åˆ°è®¾å¤‡</li>
<li><code>cudaMemcpyDeviceToHost</code>ï¼ˆDâ†’Hï¼‰ï¼šä»è®¾å¤‡æ‹·è´åˆ°ä¸»æœº</li>
<li><code>cudaMemcpyDeviceToDevice</code>ï¼ˆDâ†’Dï¼‰ï¼šåœ¨è®¾å¤‡å†…å­˜ä¹‹é—´æ‹·è´</li>
<li><code>cudaMemcpyHostToHost</code>ï¼ˆHâ†’Hï¼‰ï¼šåœ¨ä¸»æœºå†…å­˜ä¹‹é—´æ‹·è´</li>
</ul>
</li>
<li><code>stream</code>ï¼šæŒ‡å®š CUDA <strong>æµ</strong>ï¼Œæ•°æ®æ‹·è´ä»»åŠ¡å°†åœ¨è¯¥æµä¸­æ‰§è¡Œï¼ˆå¯ä½¿ç”¨ <code>0</code> ä»£è¡¨ <strong>é»˜è®¤æµ</strong>ï¼‰ã€‚</li>
</ul>
<h3 id="è¿”å›å€¼-2"><a href="#è¿”å›å€¼-2" class="headerlink" title="è¿”å›å€¼"></a><strong>è¿”å›å€¼</strong></h3><ul>
<li>**<code>cudaSuccess</code>**ï¼šæ‹·è´æˆåŠŸã€‚</li>
<li>å…¶ä»– <code>cudaError_t</code> é”™è¯¯ç ï¼šå¦‚ <code>cudaErrorInvalidValue</code>ï¼ˆå‚æ•°æ— æ•ˆï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="3-ä»£ç ç¤ºä¾‹"><a href="#3-ä»£ç ç¤ºä¾‹" class="headerlink" title="3. ä»£ç ç¤ºä¾‹"></a><strong>3. ä»£ç ç¤ºä¾‹</strong></h2><h3 id="1-åŸºæœ¬ä½¿ç”¨"><a href="#1-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="(1) åŸºæœ¬ä½¿ç”¨"></a><strong>(1) åŸºæœ¬ä½¿ç”¨</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cudaStream_t stream;</span><br><span class="line">    <span class="built_in">cudaStreamCreate</span>(&amp;stream);  <span class="comment">// åˆ›å»º CUDA æµ</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> h_data[<span class="number">100</span>], h_result[<span class="number">100</span>];  <span class="comment">// ä¸»æœºæ•°æ®</span></span><br><span class="line">    <span class="type">int</span>* d_data;  <span class="comment">// è®¾å¤‡æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">size_t</span> size = <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ†é…è®¾å¤‡å†…å­˜</span></span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_data, size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥æ‹·è´æ•°æ®åˆ°è®¾å¤‡</span></span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(d_data, h_data, size, cudaMemcpyHostToDevice, stream);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥æ‹·è´æ•°æ®å›ä¸»æœº</span></span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(h_result, d_data, size, cudaMemcpyDeviceToHost, stream);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…æµä¸­ä»»åŠ¡å®Œæˆ</span></span><br><span class="line">    <span class="built_in">cudaStreamSynchronize</span>(stream);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="built_in">cudaFree</span>(d_data);</span><br><span class="line">    <span class="built_in">cudaStreamDestroy</span>(stream);</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Async memcpy completed!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>cudaMemcpyAsync()</code> æ‰§è¡Œæ—¶ï¼ŒCPU <strong>ä¸ä¼šç­‰å¾…</strong> æ•°æ®æ‹·è´å®Œæˆï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚åªæœ‰å½“ <code>cudaStreamSynchronize()</code> è¢«è°ƒç”¨æ—¶ï¼Œæ‰ä¼šé˜»å¡ CPU ç›´åˆ°æµä¸­çš„ä»»åŠ¡å®Œæˆã€‚</p>
<hr>
<h2 id="4-cudaMemcpyAsync-ä¸-cudaMemcpy-çš„åŒºåˆ«"><a href="#4-cudaMemcpyAsync-ä¸-cudaMemcpy-çš„åŒºåˆ«" class="headerlink" title="4. cudaMemcpyAsync() ä¸ cudaMemcpy() çš„åŒºåˆ«"></a><strong>4. <code>cudaMemcpyAsync()</code> ä¸ <code>cudaMemcpy()</code> çš„åŒºåˆ«</strong></h2><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th><code>cudaMemcpy()</code></th>
<th><code>cudaMemcpyAsync()</code></th>
</tr>
</thead>
<tbody><tr>
<td><strong>åŒæ­¥&#x2F;å¼‚æ­¥</strong></td>
<td><strong>åŒæ­¥</strong>ï¼ˆé˜»å¡ CPUï¼‰</td>
<td><strong>å¼‚æ­¥</strong>ï¼ˆä¸é˜»å¡ CPUï¼‰</td>
</tr>
<tr>
<td><strong>é»˜è®¤æµ</strong></td>
<td>ä½¿ç”¨é»˜è®¤æµ <code>0</code></td>
<td>å¯ä»¥æŒ‡å®šæµ</td>
</tr>
<tr>
<td><strong>è®¡ç®—ä¸æ‹·è´é‡å </strong></td>
<td>âŒ <strong>ä¸æ”¯æŒ</strong></td>
<td>âœ… <strong>æ”¯æŒ</strong>ï¼ˆéœ€è¦ <code>cudaMemcpyAsync()</code> + <code>cudaStreamSynchronize()</code>ï¼‰</td>
</tr>
<tr>
<td><strong>é€‚ç”¨åœºæ™¯</strong></td>
<td>ç®€å•æ•°æ®æ‹·è´</td>
<td>éœ€è¦ <strong>å¹¶è¡Œæ‰§è¡Œè®¡ç®— &amp; ä¼ è¾“</strong> çš„æƒ…å†µ</td>
</tr>
</tbody></table>
<hr>
<h2 id="5-cudaMemcpyAsync-çš„é«˜çº§åº”ç”¨"><a href="#5-cudaMemcpyAsync-çš„é«˜çº§åº”ç”¨" class="headerlink" title="5. cudaMemcpyAsync() çš„é«˜çº§åº”ç”¨"></a><strong>5. <code>cudaMemcpyAsync()</code> çš„é«˜çº§åº”ç”¨</strong></h2><h3 id="1-è®¡ç®—ä¸æ•°æ®æ‹·è´é‡å "><a href="#1-è®¡ç®—ä¸æ•°æ®æ‹·è´é‡å " class="headerlink" title="(1) è®¡ç®—ä¸æ•°æ®æ‹·è´é‡å "></a><strong>(1) è®¡ç®—ä¸æ•°æ®æ‹·è´é‡å </strong></h3><p><code>cudaMemcpyAsync()</code> çš„ä¸»è¦ä¼˜åŠ¿æ˜¯ <strong>å¯ä»¥ä¸ Kernel å¹¶è¡Œæ‰§è¡Œ</strong>ï¼Œæé«˜ GPU è®¡ç®—ååé‡ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel</span><span class="params">(<span class="type">int</span>* d_data)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> idx = threadIdx.x + blockIdx.x * blockDim.x;</span><br><span class="line">    d_data[idx] *= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cudaStream_t stream;</span><br><span class="line">    <span class="built_in">cudaStreamCreate</span>(&amp;stream);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> h_data[<span class="number">100</span>], h_result[<span class="number">100</span>];</span><br><span class="line">    <span class="type">int</span>* d_data;</span><br><span class="line">    <span class="type">size_t</span> size = <span class="number">100</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;d_data, size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥æ‹·è´æ•°æ®åˆ° GPU</span></span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(d_data, h_data, size, cudaMemcpyHostToDevice, stream);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨åŒä¸€æµä¸­å¯åŠ¨ Kernelï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰</span></span><br><span class="line">    kernel&lt;&lt;&lt;<span class="number">1</span>, <span class="number">100</span>, <span class="number">0</span>, stream&gt;&gt;&gt;(d_data);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥æ‹·è´ç»“æœå›ä¸»æœº</span></span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(h_result, d_data, size, cudaMemcpyDeviceToHost, stream);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…æµå®Œæˆ</span></span><br><span class="line">    <span class="built_in">cudaStreamSynchronize</span>(stream);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(d_data);</span><br><span class="line">    <span class="built_in">cudaStreamDestroy</span>(stream);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼š</p>
<ol>
<li><strong>æ•°æ®æ‹·è´</strong>ï¼ˆ<code>cudaMemcpyAsync()</code>ï¼‰</li>
<li><strong>è®¡ç®— Kernel æ‰§è¡Œ</strong>ï¼ˆ<code>kernel&lt;&lt;&lt;&gt;&gt;&gt;</code>ï¼‰</li>
<li><strong>æ‹·è´ç»“æœå›ä¸»æœº</strong>ï¼ˆ<code>cudaMemcpyAsync()</code>ï¼‰<br>éƒ½åœ¨ <strong>åŒä¸€æµ</strong>ï¼ˆ<code>stream</code>ï¼‰ä¸­æ‰§è¡Œï¼ŒCPU <strong>ä¸ä¼šç­‰å¾…</strong>ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œåç»­ä»£ç ï¼Œæœ€ç»ˆ <code>cudaStreamSynchronize()</code> æ‰ä¼šé˜»å¡ CPUï¼Œç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚</li>
</ol>
<hr>
<h3 id="2-ä½¿ç”¨å¤šä¸ªæµå¹¶è¡Œæ‰§è¡Œä»»åŠ¡"><a href="#2-ä½¿ç”¨å¤šä¸ªæµå¹¶è¡Œæ‰§è¡Œä»»åŠ¡" class="headerlink" title="(2) ä½¿ç”¨å¤šä¸ªæµå¹¶è¡Œæ‰§è¡Œä»»åŠ¡"></a><strong>(2) ä½¿ç”¨å¤šä¸ªæµå¹¶è¡Œæ‰§è¡Œä»»åŠ¡</strong></h3><p>åœ¨å¤šæµï¼ˆMulti-streamï¼‰ç¯å¢ƒä¸‹ï¼Œå¤šä¸ª <code>cudaMemcpyAsync()</code> å¯ç”¨äº <strong>å¹¶è¡Œæ•°æ®ä¼ è¾“</strong>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cudaStream_t stream1, stream2;</span><br><span class="line"><span class="built_in">cudaStreamCreate</span>(&amp;stream1);</span><br><span class="line"><span class="built_in">cudaStreamCreate</span>(&amp;stream2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaMemcpyAsync</span>(d_data1, h_data1, size, cudaMemcpyHostToDevice, stream1);</span><br><span class="line"><span class="built_in">cudaMemcpyAsync</span>(d_data2, h_data2, size, cudaMemcpyHostToDevice, stream2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaStreamSynchronize</span>(stream1);</span><br><span class="line"><span class="built_in">cudaStreamSynchronize</span>(stream2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaStreamDestroy</span>(stream1);</span><br><span class="line"><span class="built_in">cudaStreamDestroy</span>(stream2);</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>æµ <code>stream1</code> ä¼ è¾“ <code>d_data1</code>ï¼Œæµ <code>stream2</code> ä¼ è¾“ <code>d_data2</code>ï¼Œä¸¤ä¸ªæ‹·è´ä»»åŠ¡å¯åŒæ—¶è¿›è¡Œã€‚</strong></li>
<li><strong>å¦‚æœä¸ä½¿ç”¨æµï¼ŒCUDA ä»»åŠ¡å°†ä¼šä¸²è¡Œæ‰§è¡Œï¼Œä¸èƒ½å……åˆ†åˆ©ç”¨ GPU å¸¦å®½ã€‚</strong></li>
</ul>
<hr>
<h2 id="6-cudaMemcpyAsync-å¯èƒ½çš„é”™è¯¯"><a href="#6-cudaMemcpyAsync-å¯èƒ½çš„é”™è¯¯" class="headerlink" title="6. cudaMemcpyAsync() å¯èƒ½çš„é”™è¯¯"></a><strong>6. <code>cudaMemcpyAsync()</code> å¯èƒ½çš„é”™è¯¯</strong></h2><table>
<thead>
<tr>
<th>é”™è¯¯ä»£ç </th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>cudaErrorInvalidValue</code></td>
<td>å‚æ•°æ— æ•ˆï¼ˆå¦‚ <code>dst</code> æˆ– <code>src</code> ä¸ºç©ºæŒ‡é’ˆï¼‰</td>
</tr>
<tr>
<td><code>cudaErrorInvalidMemcpyDirection</code></td>
<td><code>cudaMemcpyKind</code> ä¸åŒ¹é…ï¼ˆå¦‚ <code>cudaMemcpyDeviceToHost</code> ä½† <code>dst</code> æ˜¯è®¾å¤‡æŒ‡é’ˆï¼‰</td>
</tr>
<tr>
<td><code>cudaErrorMemoryAllocation</code></td>
<td>è®¾å¤‡å†…å­˜ä¸è¶³</td>
</tr>
<tr>
<td><code>cudaErrorIllegalAddress</code></td>
<td>è®¿é—®äº†æœªåˆ†é…æˆ–éæ³•çš„ GPU åœ°å€</td>
</tr>
</tbody></table>
<hr>
<h2 id="7-cudaMemcpyAsync-é€‚ç”¨åœºæ™¯"><a href="#7-cudaMemcpyAsync-é€‚ç”¨åœºæ™¯" class="headerlink" title="7. cudaMemcpyAsync() é€‚ç”¨åœºæ™¯"></a><strong>7. <code>cudaMemcpyAsync()</code> é€‚ç”¨åœºæ™¯</strong></h2><table>
<thead>
<tr>
<th>åº”ç”¨åœºæ™¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ•°æ®ä¼ è¾“ä¸è®¡ç®—å¹¶è¡Œ</strong></td>
<td>å¼‚æ­¥æ‹·è´ + Kernel è®¡ç®—ï¼Œå‡å°‘ CPU&#x2F;GPU ç­‰å¾…æ—¶é—´</td>
</tr>
<tr>
<td><strong>å¤šæµä»»åŠ¡è°ƒåº¦</strong></td>
<td>åœ¨ä¸åŒæµä¸­æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œæé«˜ GPU åˆ©ç”¨ç‡</td>
</tr>
<tr>
<td><strong>æ‰¹é‡æ•°æ®å¤„ç†</strong></td>
<td>é¢„åŠ è½½æ•°æ®ï¼Œæé«˜æ•°æ®ååé‡</td>
</tr>
</tbody></table>
<hr>
<h2 id="8-æ€»ç»“-1"><a href="#8-æ€»ç»“-1" class="headerlink" title="8. æ€»ç»“"></a><strong>8. æ€»ç»“</strong></h2><ul>
<li><code>cudaMemcpyAsync()</code> <strong>å¼‚æ­¥</strong> è¿›è¡Œæ•°æ®æ‹·è´ï¼Œä¸ä¼šé˜»å¡ CPUã€‚</li>
<li>éœ€è¦ <strong>æŒ‡å®š CUDA æµ</strong>ï¼Œå¦åˆ™é»˜è®¤ä½¿ç”¨ <code>0</code>ï¼ˆé»˜è®¤æµï¼‰ã€‚</li>
<li>éœ€è¦ <strong>é…åˆ <code>cudaStreamSynchronize()</code></strong> ç¡®ä¿æ•°æ®æ­£ç¡®æ€§ã€‚</li>
<li>é€‚ç”¨äº <strong>æ•°æ®ä¼ è¾“ + è®¡ç®—å¹¶è¡Œæ‰§è¡Œ</strong>ï¼Œæé«˜ GPU è®¡ç®—ååé‡ã€‚</li>
</ul>
<p>åˆç†ä½¿ç”¨ <code>cudaMemcpyAsync()</code> å¯ä»¥ <strong>æå‡ CUDA åº”ç”¨çš„æ€§èƒ½</strong>ï¼Œå°¤å…¶åœ¨ <strong>æ·±åº¦å­¦ä¹ ã€ç§‘å­¦è®¡ç®—ã€å¤§è§„æ¨¡æ•°æ®å¤„ç†</strong> ç­‰åœºæ™¯ä¸‹è¡¨ç°çªå‡ºï¼ğŸš€</p>

    </div>

    
    
    
        <div class="reward-container">
  <div>æ„Ÿè°¢è€æ¿æ”¯æŒï¼æ•¬ç¤¼(^^ã‚</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="zhang junyi WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="zhang junyi Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CUDA/" rel="tag"># CUDA</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/02/18/notebook/NVIDIA/TensorRT/2025-02-18--%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" rel="prev" title="TensorRT å¸¸ç”¨å‡½æ•°">
      <i class="fa fa-chevron-left"></i> TensorRT å¸¸ç”¨å‡½æ•°
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/02/18/notebook/Tools/2025-02-18--TwinCAT/" rel="next" title="TwinCAT">
      TwinCAT <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cudaSetDevice-%E5%87%BD%E6%95%B0-%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">cudaSetDevice() å‡½æ•° è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cudaSetDevice-%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.1.</span> <span class="nav-text">cudaSetDevice() å‡½æ•°è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BD%9C%E7%94%A8"><span class="nav-number">2.1.1.</span> <span class="nav-text">1. ä½œç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%AF%AD%E6%B3%95"><span class="nav-number">2.1.2.</span> <span class="nav-text">2. è¯­æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%9B%B8%E5%85%B3%E8%AF%B4%E6%98%8E"><span class="nav-number">2.1.3.</span> <span class="nav-text">3. ç›¸å…³è¯´æ˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.1.4.</span> <span class="nav-text">4. ä»£ç ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%AE%BE%E5%A4%87"><span class="nav-number">2.1.5.</span> <span class="nav-text">5. è·å–å½“å‰è®¾å¤‡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E7%BA%BF%E7%A8%8B%E4%B8%8E%E8%AE%BE%E5%A4%87%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">2.1.6.</span> <span class="nav-text">6. çº¿ç¨‹ä¸è®¾å¤‡çš„å…³ç³»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-%E5%8F%AF%E8%83%BD%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">2.1.7.</span> <span class="nav-text">7. å¯èƒ½çš„é”™è¯¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-%E7%BB%93%E5%90%88-cudaGetDeviceCount"><span class="nav-number">2.1.8.</span> <span class="nav-text">8. ç»“åˆ cudaGetDeviceCount()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-%E6%80%BB%E7%BB%93"><span class="nav-number">2.1.9.</span> <span class="nav-text">9. æ€»ç»“</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cudaMalloc-%E5%87%BD%E6%95%B0-%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.</span> <span class="nav-text">cudaMalloc() å‡½æ•° è¯¦è§£</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cudaMalloc-%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number"></span> <span class="nav-text">cudaMalloc() å‡½æ•°è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BD%9C%E7%94%A8-1"><span class="nav-number">1.</span> <span class="nav-text">1. ä½œç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%AF%AD%E6%B3%95-1"><span class="nav-number">2.</span> <span class="nav-text">2. è¯­æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">2.2.</span> <span class="nav-text">è¿”å›å€¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.</span> <span class="nav-text">3. ä½¿ç”¨ç¤ºä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9C%A8-GPU-%E8%AE%BE%E5%A4%87%E4%B8%8A%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98"><span class="nav-number">3.1.</span> <span class="nav-text">(1) åœ¨ GPU è®¾å¤‡ä¸Šåˆ†é…å†…å­˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E7%9B%B8%E5%85%B3%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">4.</span> <span class="nav-text">4. ç›¸å…³æ³¨æ„äº‹é¡¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%AE%BE%E5%A4%87%E6%8C%87%E9%92%88%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E5%9C%A8%E4%B8%BB%E6%9C%BA%EF%BC%88CPU%EF%BC%89%E7%AB%AF%E8%AE%BF%E9%97%AE"><span class="nav-number">4.1.</span> <span class="nav-text">(1) è®¾å¤‡æŒ‡é’ˆä¸èƒ½ç›´æ¥åœ¨ä¸»æœºï¼ˆCPUï¼‰ç«¯è®¿é—®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%AE%BE%E5%A4%87%E5%86%85%E5%AD%98%E9%9C%80%E8%A6%81%E6%89%8B%E5%8A%A8%E9%87%8A%E6%94%BE"><span class="nav-number">4.2.</span> <span class="nav-text">(2) è®¾å¤‡å†…å­˜éœ€è¦æ‰‹åŠ¨é‡Šæ”¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%A3%80%E6%9F%A5-cudaMalloc-%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F"><span class="nav-number">4.3.</span> <span class="nav-text">(3) æ£€æŸ¥ cudaMalloc() æ˜¯å¦æˆåŠŸ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E8%AE%A1%E7%AE%97%E8%AE%BE%E5%A4%87%E5%86%85%E5%AD%98%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="nav-number">4.4.</span> <span class="nav-text">(4) è®¡ç®—è®¾å¤‡å†…å­˜çš„ä½¿ç”¨æƒ…å†µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%A4%9A-GPU-%E7%8E%AF%E5%A2%83"><span class="nav-number">4.5.</span> <span class="nav-text">(5) å¤š GPU ç¯å¢ƒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-cudaMalloc-%E4%B8%8E%E5%85%B6%E4%BB%96-CUDA-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%87%BD%E6%95%B0%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">5.</span> <span class="nav-text">5. cudaMalloc() ä¸å…¶ä»– CUDA å†…å­˜ç®¡ç†å‡½æ•°çš„æ¯”è¾ƒ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">6. æ€»ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cudaStreamCreate-%E5%87%BD%E6%95%B0-%E8%AF%A6%E8%A7%A3"><span class="nav-number">7.</span> <span class="nav-text">cudaStreamCreate() å‡½æ•° è¯¦è§£</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cudaStreamCreate-%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number"></span> <span class="nav-text">cudaStreamCreate() å‡½æ•°è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BD%9C%E7%94%A8-2"><span class="nav-number">1.</span> <span class="nav-text">1. ä½œç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%AF%AD%E6%B3%95-2"><span class="nav-number">2.</span> <span class="nav-text">2. è¯­æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0-1"><span class="nav-number">2.1.</span> <span class="nav-text">å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-1"><span class="nav-number">2.2.</span> <span class="nav-text">è¿”å›å€¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B-1"><span class="nav-number">3.</span> <span class="nav-text">3. ä½¿ç”¨ç¤ºä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%88%9B%E5%BB%BA%E5%B9%B6%E4%BD%BF%E7%94%A8-CUDA-%E6%B5%81"><span class="nav-number">3.1.</span> <span class="nav-text">(1) åˆ›å»ºå¹¶ä½¿ç”¨ CUDA æµ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">4. ç›¸å…³å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-cudaStreamDestroy-%E9%94%80%E6%AF%81-CUDA-%E6%B5%81"><span class="nav-number">4.1.</span> <span class="nav-text">(1) cudaStreamDestroy() - é”€æ¯ CUDA æµ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-cudaMemcpyAsync-%E5%BC%82%E6%AD%A5%E6%8B%B7%E8%B4%9D"><span class="nav-number">4.2.</span> <span class="nav-text">(2) cudaMemcpyAsync() - å¼‚æ­¥æ‹·è´</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-cudaStreamSynchronize-%E7%AD%89%E5%BE%85%E6%B5%81%E5%AE%8C%E6%88%90"><span class="nav-number">4.3.</span> <span class="nav-text">(3) cudaStreamSynchronize() - ç­‰å¾…æµå®Œæˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-CUDA-%E6%B5%81%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">5.</span> <span class="nav-text">5. CUDA æµçš„ç‰¹ç‚¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E9%BB%98%E8%AE%A4%E6%B5%81%EF%BC%88cudaStream-t-0-%EF%BC%89"><span class="nav-number">5.1.</span> <span class="nav-text">(1) é»˜è®¤æµï¼ˆcudaStream_t(0)ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E6%B5%81%EF%BC%88%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="nav-number">5.2.</span> <span class="nav-text">(2) ç”¨æˆ·å®šä¹‰æµï¼ˆå¼‚æ­¥æ‰§è¡Œï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA-CUDA-%E6%B5%81%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">6.</span> <span class="nav-text">6. ä½¿ç”¨å¤šä¸ª CUDA æµçš„åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-cudaStreamCreate-%E5%8F%AF%E8%83%BD%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">7.</span> <span class="nav-text">7. cudaStreamCreate() å¯èƒ½çš„é”™è¯¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%80%BB%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">8. æ€»ç»“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cudaMemcpyAsync-%E5%87%BD%E6%95%B0-%E8%AF%A6%E8%A7%A3"><span class="nav-number">9.</span> <span class="nav-text">cudaMemcpyAsync() å‡½æ•° è¯¦è§£</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cudaMemcpyAsync-%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="nav-number"></span> <span class="nav-text">cudaMemcpyAsync() å‡½æ•°è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BD%9C%E7%94%A8-3"><span class="nav-number">1.</span> <span class="nav-text">1. ä½œç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%AF%AD%E6%B3%95-3"><span class="nav-number">2.</span> <span class="nav-text">2. è¯­æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0-2"><span class="nav-number">2.1.</span> <span class="nav-text">å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-2"><span class="nav-number">2.2.</span> <span class="nav-text">è¿”å›å€¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.</span> <span class="nav-text">3. ä»£ç ç¤ºä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">(1) åŸºæœ¬ä½¿ç”¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-cudaMemcpyAsync-%E4%B8%8E-cudaMemcpy-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.</span> <span class="nav-text">4. cudaMemcpyAsync() ä¸ cudaMemcpy() çš„åŒºåˆ«</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-cudaMemcpyAsync-%E7%9A%84%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8"><span class="nav-number">5.</span> <span class="nav-text">5. cudaMemcpyAsync() çš„é«˜çº§åº”ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%AE%A1%E7%AE%97%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%8B%B7%E8%B4%9D%E9%87%8D%E5%8F%A0"><span class="nav-number">5.1.</span> <span class="nav-text">(1) è®¡ç®—ä¸æ•°æ®æ‹·è´é‡å </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA%E6%B5%81%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1"><span class="nav-number">5.2.</span> <span class="nav-text">(2) ä½¿ç”¨å¤šä¸ªæµå¹¶è¡Œæ‰§è¡Œä»»åŠ¡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-cudaMemcpyAsync-%E5%8F%AF%E8%83%BD%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">6.</span> <span class="nav-text">6. cudaMemcpyAsync() å¯èƒ½çš„é”™è¯¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-cudaMemcpyAsync-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">7.</span> <span class="nav-text">7. cudaMemcpyAsync() é€‚ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%80%BB%E7%BB%93-1"><span class="nav-number">8.</span> <span class="nav-text">8. æ€»ç»“</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zhang junyi</p>
  <div class="site-description" itemprop="description">å·¥ä½œå­¦ä¹ ç¬”è®°</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">686</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">99</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/junyiha" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;junyiha" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://x.com/zhangjunyiha" title="Twitter â†’ https:&#x2F;&#x2F;x.com&#x2F;zhangjunyiha" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhang junyi</span>
</div>

<!--
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
