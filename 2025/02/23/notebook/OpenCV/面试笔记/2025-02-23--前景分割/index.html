<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"junyiha.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="简介 OpenCV 前景分割">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCV 前景分割">
<meta property="og:url" content="https://junyiha.github.io/2025/02/23/notebook/OpenCV/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/2025-02-23--%E5%89%8D%E6%99%AF%E5%88%86%E5%89%B2/index.html">
<meta property="og:site_name" content="junyi&#39;s blog">
<meta property="og:description" content="简介 OpenCV 前景分割">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-23T01:00:00.000Z">
<meta property="article:modified_time" content="2025-04-28T08:08:39.449Z">
<meta property="article:author" content="zhang junyi">
<meta property="article:tag" content="OpenCV">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://junyiha.github.io/2025/02/23/notebook/OpenCV/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/2025-02-23--%E5%89%8D%E6%99%AF%E5%88%86%E5%89%B2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>OpenCV 前景分割 | junyi's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">junyi's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">hahahahaha</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://junyiha.github.io/2025/02/23/notebook/OpenCV/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/2025-02-23--%E5%89%8D%E6%99%AF%E5%88%86%E5%89%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhang junyi">
      <meta itemprop="description" content="工作学习笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="junyi's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          OpenCV 前景分割
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-02-23 09:00:00" itemprop="dateCreated datePublished" datetime="2025-02-23T09:00:00+08:00">2025-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-04-28 16:08:39" itemprop="dateModified" datetime="2025-04-28T16:08:39+08:00">2025-04-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OpenCV/" itemprop="url" rel="index"><span itemprop="name">OpenCV</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li>OpenCV 前景分割</li>
</ul>
<span id="more"></span>

<h2 id="详细解释高斯混合模型"><a href="#详细解释高斯混合模型" class="headerlink" title="详细解释高斯混合模型"></a>详细解释高斯混合模型</h2><p>高斯混合模型（Gaussian Mixture Model, <strong>GMM</strong>）是一种基于概率统计的模型，常用于对复杂数据分布进行建模。在计算机视觉中，GMM 被广泛用于背景减除（如 OpenCV 的 MOG&#x2F;MOG2 算法），以分离动态场景中的前景和背景。以下是对 GMM 的详细解释：</p>
<hr>
<h3 id="1-GMM-的核心思想"><a href="#1-GMM-的核心思想" class="headerlink" title="1. GMM 的核心思想"></a><strong>1. GMM 的核心思想</strong></h3><p>GMM 假设数据是由多个高斯分布（即正态分布）的加权组合生成的。每个高斯分布代表一种可能的“模式”（如背景或前景），权重表示该模式在整体数据中的重要性。</p>
<ul>
<li><p><strong>单高斯模型</strong>：假设数据服从单一高斯分布（例如静态背景）。<br><strong>局限性</strong>：无法处理动态背景（如树叶晃动、光线变化）。</p>
</li>
<li><p><strong>高斯混合模型</strong>：使用多个高斯分布的组合，更灵活地建模复杂场景（如动态背景+移动前景）。</p>
</li>
</ul>
<hr>
<h3 id="2-数学定义"><a href="#2-数学定义" class="headerlink" title="2. 数学定义"></a><strong>2. 数学定义</strong></h3><p>GMM 的概率密度函数为多个高斯分布的加权和：</p>
<p>$$<br>p(x) &#x3D; \sum_{k&#x3D;1}^K \pi_k \cdot \mathcal{N}(x; \mu_k, \Sigma_k)<br>$$</p>
<ul>
<li>$K$：高斯分布的数量（OpenCV MOG2 默认为 5）。</li>
<li>$\pi_k$：第 $k$ 个高斯分布的权重，满足 $\sum \pi_k &#x3D; 1$。</li>
<li>$\mathcal{N}(x; \mu_k, \Sigma_k)$：均值为 $\mu_k$、协方差矩阵为 $\Sigma_k$ 的高斯分布。</li>
</ul>
<p>在背景减除中，每个像素的亮度&#x2F;颜色值被建模为多个高斯分布的混合。</p>
<hr>
<h3 id="3-GMM-在背景减除中的应用"><a href="#3-GMM-在背景减除中的应用" class="headerlink" title="3. GMM 在背景减除中的应用"></a><strong>3. GMM 在背景减除中的应用</strong></h3><p>在 OpenCV 的 <code>MOG2</code> 算法中，每个像素的时序变化由多个高斯分布描述：</p>
<h4 id="步骤-1：初始化模型"><a href="#步骤-1：初始化模型" class="headerlink" title="步骤 1：初始化模型"></a><strong>步骤 1：初始化模型</strong></h4><ul>
<li>为每个像素初始化 $K$ 个高斯分布（例如 $K&#x3D;5$）。</li>
<li>初始均值和方差通常基于前几帧的像素值。</li>
</ul>
<h4 id="步骤-2：更新模型"><a href="#步骤-2：更新模型" class="headerlink" title="步骤 2：更新模型"></a><strong>步骤 2：更新模型</strong></h4><p>对每一帧的每个像素值 $x_t$：</p>
<ol>
<li><strong>匹配高斯分布</strong>：检查 $x_t$ 是否落在某个高斯分布的 $\pm 2.5\sigma$ 范围内。</li>
<li><strong>更新参数</strong>：<ul>
<li>若匹配到第 $k$ 个分布，更新其参数：<br>$$<br>\mu_k \leftarrow (1-\alpha)\mu_k + \alpha x_t<br>$$<br>$$<br>\sigma_k^2 \leftarrow (1-\alpha)\sigma_k^2 + \alpha (x_t - \mu_k)^T(x_t - \mu_k)<br>$$<ul>
<li>$\alpha$：学习率（如 0.005），控制更新速度。</li>
</ul>
</li>
<li>若未匹配到任何分布，用新分布替换权重最小的分布。</li>
</ul>
</li>
<li><strong>调整权重</strong>：<br>$$<br>\pi_k \leftarrow (1-\alpha)\pi_k + \alpha \cdot M_k<br>$$<ul>
<li>$M_k &#x3D; 1$ 若匹配到该分布，否则 $M_k &#x3D; 0$。</li>
</ul>
</li>
</ol>
<h4 id="步骤-3：选择背景模型"><a href="#步骤-3：选择背景模型" class="headerlink" title="步骤 3：选择背景模型"></a><strong>步骤 3：选择背景模型</strong></h4><ul>
<li>按权重 $\pi_k$ 与方差 $\sigma_k$ 的比值排序高斯分布。</li>
<li>选择前 $B$ 个分布作为背景，满足：<br>$$<br>B &#x3D; \arg\min_b \left( \sum_{k&#x3D;1}^b \pi_k &gt; T \right)<br>$$<ul>
<li>$T$ 为背景阈值（如 0.7），表示背景应覆盖至少 70% 的数据。</li>
</ul>
</li>
</ul>
<h4 id="步骤-4：前景检测"><a href="#步骤-4：前景检测" class="headerlink" title="步骤 4：前景检测"></a><strong>步骤 4：前景检测</strong></h4><ul>
<li>若像素值未匹配到任何背景分布，则标记为前景。</li>
</ul>
<hr>
<h3 id="4-关键参数与优化"><a href="#4-关键参数与优化" class="headerlink" title="4. 关键参数与优化"></a><strong>4. 关键参数与优化</strong></h3><p>在 OpenCV 的 <code>createBackgroundSubtractorMOG2</code> 中，关键参数包括：</p>
<ul>
<li>**<code>history</code>**：用于建模背景的帧数（默认 500）。值越大，模型适应变化越慢。</li>
<li>**<code>varThreshold</code>**：方差阈值，决定是否将像素归类为前景（默认 16）。值越小，对运动越敏感。</li>
<li>**<code>detectShadows</code>**：是否检测阴影（默认为 <code>True</code>）。阴影会被标记为灰色（需后续处理）。</li>
</ul>
<hr>
<h3 id="5-GMM-的优缺点"><a href="#5-GMM-的优缺点" class="headerlink" title="5. GMM 的优缺点"></a><strong>5. GMM 的优缺点</strong></h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a><strong>优点</strong></h4><ul>
<li>适应动态背景（如水面波纹、摇晃的树叶）。</li>
<li>实时性好，适合视频流处理。</li>
<li>可在线更新模型参数。</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a><strong>缺点</strong></h4><ul>
<li>计算复杂度随 $K$ 增加而升高。</li>
<li>对快速光照变化敏感。</li>
<li>需要手动调整参数（如 $K$, $\alpha$, $T$）。</li>
</ul>
<hr>
<h3 id="6-代码示例（OpenCV-MOG2）"><a href="#6-代码示例（OpenCV-MOG2）" class="headerlink" title="6. 代码示例（OpenCV MOG2）"></a><strong>6. 代码示例（OpenCV MOG2）</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化 MOG2 背景减除器</span></span><br><span class="line">bg_subtractor = cv2.createBackgroundSubtractorMOG2(</span><br><span class="line">    history=<span class="number">500</span>,       <span class="comment"># 使用 500 帧建模背景</span></span><br><span class="line">    varThreshold=<span class="number">16</span>,   <span class="comment"># 方差阈值</span></span><br><span class="line">    detectShadows=<span class="literal">True</span> <span class="comment"># 检测阴影（阴影标记为灰色）</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(<span class="string">&quot;input.mp4&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> cap.isOpened():</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 生成前景掩膜（背景为黑色，前景为白色，阴影为灰色）</span></span><br><span class="line">    fg_mask = bg_subtractor.apply(frame)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 去除阴影（可选）</span></span><br><span class="line">    _, fg_mask = cv2.threshold(fg_mask, <span class="number">254</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    </span><br><span class="line">    cv2.imshow(<span class="string">&quot;Foreground&quot;</span>, fg_mask)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">30</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">cap.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-总结"><a href="#7-总结" class="headerlink" title="7. 总结"></a><strong>7. 总结</strong></h3><p>GMM 通过多个高斯分布的动态组合，有效建模复杂背景，是背景减除的核心技术之一。在 OpenCV 中，<code>MOG2</code> 通过自适应更新和方差阈值机制，兼顾了实时性和准确性。理解其数学原理和参数调整方法，可显著提升前景分割的效果。</p>
<h2 id="OpenCV-前景分割"><a href="#OpenCV-前景分割" class="headerlink" title="OpenCV 前景分割"></a>OpenCV 前景分割</h2><p>在OpenCV中实现前景分割（即将图像中的前景物体与背景分离）通常可以通过多种方法实现，以下是一些常见的技术和代码示例：</p>
<hr>
<h3 id="1-背景减除（Background-Subtraction）"><a href="#1-背景减除（Background-Subtraction）" class="headerlink" title="1. 背景减除（Background Subtraction）"></a><strong>1. 背景减除（Background Subtraction）</strong></h3><p>适用于视频流或动态场景中的移动前景分割。OpenCV提供了多种背景减除算法（如MOG2、KNN）。</p>
<h4 id="代码示例（MOG2算法）"><a href="#代码示例（MOG2算法）" class="headerlink" title="代码示例（MOG2算法）"></a><strong>代码示例（MOG2算法）</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化背景减除器</span></span><br><span class="line">bg_subtractor = cv2.createBackgroundSubtractorMOG2(history=<span class="number">500</span>, varThreshold=<span class="number">50</span>, detectShadows=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(<span class="string">&quot;input_video.mp4&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> cap.isOpened():</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 应用背景减除</span></span><br><span class="line">    fg_mask = bg_subtractor.apply(frame)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 可选：形态学操作（去噪、填充空洞）</span></span><br><span class="line">    kernel = cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (<span class="number">5</span>,<span class="number">5</span>))</span><br><span class="line">    fg_mask = cv2.morphologyEx(fg_mask, cv2.MORPH_CLOSE, kernel)</span><br><span class="line">    </span><br><span class="line">    cv2.imshow(<span class="string">&quot;Foreground Mask&quot;</span>, fg_mask)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">30</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">cap.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-GrabCut-算法"><a href="#2-GrabCut-算法" class="headerlink" title="2. GrabCut 算法"></a><strong>2. GrabCut 算法</strong></h3><p>基于交互式图像分割的算法，适用于静态图像的前景提取。需要用户指定一个包含前景的矩形框。</p>
<h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a><strong>代码示例</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">&quot;image.jpg&quot;</span>)</span><br><span class="line">mask = np.zeros(img.shape[:<span class="number">2</span>], np.uint8)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化背景和前景模型</span></span><br><span class="line">bgd_model = np.zeros((<span class="number">1</span>,<span class="number">65</span>), np.float64)</span><br><span class="line">fgd_model = np.zeros((<span class="number">1</span>,<span class="number">65</span>), np.float64)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户指定矩形框（x,y,w,h）</span></span><br><span class="line">rect = (<span class="number">50</span>, <span class="number">50</span>, <span class="number">450</span>, <span class="number">290</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行GrabCut算法</span></span><br><span class="line">cv2.grabCut(img, mask, rect, bgd_model, fgd_model, iterCount=<span class="number">5</span>, mode=cv2.GC_INIT_WITH_RECT)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取前景掩膜（0:背景, 2:可能背景, 1:前景, 3:可能前景）</span></span><br><span class="line">foreground_mask = np.where((mask == <span class="number">1</span>) | (mask == <span class="number">3</span>), <span class="number">255</span>, <span class="number">0</span>).astype(<span class="string">&quot;uint8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用掩膜提取前景</span></span><br><span class="line">result = cv2.bitwise_and(img, img, mask=foreground_mask)</span><br><span class="line"></span><br><span class="line">cv2.imshow(<span class="string">&quot;Result&quot;</span>, result)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-深度学习模型（如Mask-R-CNN）"><a href="#3-深度学习模型（如Mask-R-CNN）" class="headerlink" title="3. 深度学习模型（如Mask R-CNN）"></a><strong>3. 深度学习模型（如Mask R-CNN）</strong></h3><p>使用预训练的深度学习模型进行像素级分割（需要安装<code>opencv-python</code>和模型文件）。</p>
<h4 id="代码示例（使用预训练模型）"><a href="#代码示例（使用预训练模型）" class="headerlink" title="代码示例（使用预训练模型）"></a><strong>代码示例（使用预训练模型）</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载预训练模型和权重</span></span><br><span class="line">net = cv2.dnn.readNetFromTensorflow(<span class="string">&quot;frozen_inference_graph.pb&quot;</span>, <span class="string">&quot;mask_rcnn.pbtxt&quot;</span>)</span><br><span class="line"></span><br><span class="line">img = cv2.imread(<span class="string">&quot;image.jpg&quot;</span>)</span><br><span class="line">height, width = img.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入预处理</span></span><br><span class="line">blob = cv2.dnn.blobFromImage(img, swapRB=<span class="literal">True</span>)</span><br><span class="line">net.setInput(blob)</span><br><span class="line">boxes, masks = net.forward([<span class="string">&quot;detection_out_final&quot;</span>, <span class="string">&quot;detection_masks&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取第一个检测到的对象的掩膜</span></span><br><span class="line">num_detections = boxes.shape[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_detections):</span><br><span class="line">    class_id = <span class="built_in">int</span>(boxes[<span class="number">0</span>, <span class="number">0</span>, i, <span class="number">1</span>])</span><br><span class="line">    score = boxes[<span class="number">0</span>, <span class="number">0</span>, i, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> score &gt; <span class="number">0.5</span>:  <span class="comment"># 置信度阈值</span></span><br><span class="line">        <span class="comment"># 提取掩膜并二值化</span></span><br><span class="line">        mask = masks[i, class_id]</span><br><span class="line">        mask = cv2.resize(mask, (width, height))</span><br><span class="line">        mask = (mask &gt; <span class="number">0.5</span>).astype(np.uint8) * <span class="number">255</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 应用掩膜</span></span><br><span class="line">        result = cv2.bitwise_and(img, img, mask=mask)</span><br><span class="line">        cv2.imshow(<span class="string">&quot;Segmented Object&quot;</span>, result)</span><br><span class="line">        cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-其他方法"><a href="#4-其他方法" class="headerlink" title="4. 其他方法"></a><strong>4. 其他方法</strong></h3><ul>
<li><strong>颜色分割</strong>：基于颜色阈值（如HSV空间）提取特定颜色的前景。</li>
<li><strong>运动检测</strong>：通过帧间差分法检测移动物体。</li>
<li><strong>U-Net等轻量模型</strong>：适用于自定义数据集的实时分割。</li>
</ul>
<hr>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a><strong>注意事项</strong></h3><ol>
<li><strong>背景减除参数调整</strong>：根据场景调整<code>history</code>（历史帧数）、<code>varThreshold</code>（方差阈值）等参数。</li>
<li><strong>阴影处理</strong>：MOG2支持<code>detectShadows=True</code>，但需后续处理阴影标记（灰色区域）。</li>
<li><strong>深度学习模型依赖</strong>：需下载预训练模型文件（如Mask R-CNN的<code>frozen_inference_graph.pb</code>）。</li>
</ol>
<p>根据具体场景选择合适的方法：动态视频推荐背景减除，静态图像推荐GrabCut或深度学习模型。</p>
<h2 id="OpenCV-前景分割-KNN方法"><a href="#OpenCV-前景分割-KNN方法" class="headerlink" title="OpenCV 前景分割 KNN方法"></a>OpenCV 前景分割 KNN方法</h2><p>在OpenCV中，使用KNN（K-Nearest Neighbors）背景减除方法进行前景分割是一种基于统计模型的动态背景建模技术，适用于视频流中移动目标的检测。以下是详细的步骤说明、参数解析及代码示例：</p>
<hr>
<h3 id="1-KNN背景减除器原理"><a href="#1-KNN背景减除器原理" class="headerlink" title="1. KNN背景减除器原理"></a><strong>1. KNN背景减除器原理</strong></h3><ul>
<li><strong>核心思想</strong>：通过维护每个像素点的历史样本集合，利用KNN算法判断当前像素是否属于背景。</li>
<li><strong>优势</strong>：对动态背景（如树叶晃动、水面波纹）有较好的适应性，支持阴影检测。</li>
<li><strong>适用场景</strong>：监控视频、交通流量分析等动态环境中的前景分割。</li>
</ul>
<hr>
<h3 id="2-OpenCV中的KNN背景减除器"><a href="#2-OpenCV中的KNN背景减除器" class="headerlink" title="2. OpenCV中的KNN背景减除器"></a><strong>2. OpenCV中的KNN背景减除器</strong></h3><h4 id="2-1-创建KNN背景减除器"><a href="#2-1-创建KNN背景减除器" class="headerlink" title="2.1 创建KNN背景减除器"></a><strong>2.1 创建KNN背景减除器</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化KNN背景减除器</span></span><br><span class="line">bg_subtractor = cv2.createBackgroundSubtractorKNN(</span><br><span class="line">    history=<span class="number">500</span>,        <span class="comment"># 用于建模背景的帧数（默认500）</span></span><br><span class="line">    dist2Threshold=<span class="number">400</span>, <span class="comment"># 距离平方阈值（判断是否为背景的临界值，默认400）</span></span><br><span class="line">    detectShadows=<span class="literal">True</span>  <span class="comment"># 是否检测阴影（默认True，阴影标记为灰色）</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="2-2-关键参数解析"><a href="#2-2-关键参数解析" class="headerlink" title="2.2 关键参数解析"></a><strong>2.2 关键参数解析</strong></h4><ul>
<li><p>**<code>history</code>**（历史帧数）：</p>
<ul>
<li>值越大，背景模型更新越慢（更稳定，但可能滞后于变化）。</li>
<li>值越小，模型适应变化更快（但对噪声更敏感）。</li>
</ul>
</li>
<li><p>**<code>dist2Threshold</code>**（距离平方阈值）：</p>
<ul>
<li>当前像素与背景样本的欧氏距离平方的阈值。</li>
<li>值越大，对前景检测越宽松（可能包含更多噪声）；值越小，检测越严格。</li>
</ul>
</li>
<li><p>**<code>detectShadows</code>**（阴影检测）：</p>
<ul>
<li>若为<code>True</code>，阴影会被标记为灰色（需后续处理）。</li>
<li>若为<code>False</code>，阴影区域将被归为前景。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-完整代码示例"><a href="#3-完整代码示例" class="headerlink" title="3. 完整代码示例"></a><strong>3. 完整代码示例</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化KNN背景减除器</span></span><br><span class="line">bg_subtractor = cv2.createBackgroundSubtractorKNN(history=<span class="number">500</span>, detectShadows=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开视频文件或摄像头</span></span><br><span class="line">cap = cv2.VideoCapture(<span class="string">&#x27;input_video.mp4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> cap.isOpened():</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 应用KNN背景减除，获取前景掩膜</span></span><br><span class="line">    fg_mask = bg_subtractor.apply(frame)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 去除阴影（可选：将灰色阴影设为背景）</span></span><br><span class="line">    <span class="keyword">if</span> bg_subtractor.getDetectShadows():</span><br><span class="line">        _, fg_mask = cv2.threshold(fg_mask, <span class="number">254</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 形态学操作去噪</span></span><br><span class="line">    kernel = cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">    fg_mask = cv2.morphologyEx(fg_mask, cv2.MORPH_CLOSE, kernel)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 显示结果</span></span><br><span class="line">    cv2.imshow(<span class="string">&#x27;Original Frame&#x27;</span>, frame)</span><br><span class="line">    cv2.imshow(<span class="string">&#x27;Foreground Mask&#x27;</span>, fg_mask)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">30</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">cap.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-结果优化技巧"><a href="#4-结果优化技巧" class="headerlink" title="4. 结果优化技巧"></a><strong>4. 结果优化技巧</strong></h3><h4 id="4-1-形态学滤波"><a href="#4-1-形态学滤波" class="headerlink" title="4.1 形态学滤波"></a><strong>4.1 形态学滤波</strong></h4><ul>
<li><strong>开运算</strong>（先腐蚀后膨胀）：去除小噪声点。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fg_mask = cv2.morphologyEx(fg_mask, cv2.MORPH_OPEN, kernel)</span><br></pre></td></tr></table></figure></li>
<li><strong>闭运算</strong>（先膨胀后腐蚀）：填充前景中的空洞。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fg_mask = cv2.morphologyEx(fg_mask, cv2.MORPH_CLOSE, kernel)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-2-阴影处理"><a href="#4-2-阴影处理" class="headerlink" title="4.2 阴影处理"></a><strong>4.2 阴影处理</strong></h4><ul>
<li>若启用阴影检测（<code>detectShadows=True</code>），阴影在掩膜中标记为灰色（值&#x3D;127）。</li>
<li>通过阈值处理将阴影归为背景：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_, fg_mask = cv2.threshold(fg_mask, <span class="number">254</span>, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-3-参数调优"><a href="#4-3-参数调优" class="headerlink" title="4.3 参数调优"></a><strong>4.3 参数调优</strong></h4><ul>
<li>**调整<code>dist2Threshold</code>**：若前景漏检，降低阈值；若噪声多，增大阈值。</li>
<li>**调整<code>history</code>**：快速变化场景使用较小的历史帧数（如200）。</li>
</ul>
<hr>
<h3 id="5-对比KNN与MOG2"><a href="#5-对比KNN与MOG2" class="headerlink" title="5. 对比KNN与MOG2"></a><strong>5. 对比KNN与MOG2</strong></h3><table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>KNN</strong></th>
<th><strong>MOG2</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>算法基础</strong></td>
<td>K-最近邻分类</td>
<td>混合高斯模型</td>
</tr>
<tr>
<td><strong>计算开销</strong></td>
<td>较高（需维护更多样本）</td>
<td>较低</td>
</tr>
<tr>
<td><strong>动态背景适应性</strong></td>
<td>较好</td>
<td>中等</td>
</tr>
<tr>
<td><strong>阴影处理</strong></td>
<td>支持（可选标记阴影）</td>
<td>支持（可选标记阴影）</td>
</tr>
<tr>
<td><strong>实时性</strong></td>
<td>略低于MOG2</td>
<td>较高</td>
</tr>
</tbody></table>
<hr>
<h3 id="6-实际应用建议"><a href="#6-实际应用建议" class="headerlink" title="6. 实际应用建议"></a><strong>6. 实际应用建议</strong></h3><ul>
<li><strong>静态摄像头场景</strong>：优先使用KNN，因其对动态背景鲁棒性更强。</li>
<li><strong>资源受限环境</strong>：选择MOG2以获得更快处理速度。</li>
<li><strong>阴影敏感场景</strong>：启用阴影检测并通过后处理过滤灰色区域。</li>
<li><strong>多目标追踪</strong>：结合轮廓检测（<code>cv2.findContours</code>）分析前景掩膜中的物体。</li>
</ul>
<hr>
<h3 id="7-常见问题解决"><a href="#7-常见问题解决" class="headerlink" title="7. 常见问题解决"></a><strong>7. 常见问题解决</strong></h3><ul>
<li><p><strong>问题1：前景掩膜噪声过多</strong><br><strong>方案</strong>：增大<code>dist2Threshold</code>，或对掩膜应用更强烈的形态学滤波。</p>
</li>
<li><p><strong>问题2：背景更新滞后</strong><br><strong>方案</strong>：减小<code>history</code>值，或手动调用<code>apply()</code>时设置学习率（需修改源码逻辑）。</p>
</li>
<li><p><strong>问题3：阴影误判为前景</strong><br><strong>方案</strong>：启用<code>detectShadows=True</code>，并通过阈值处理移除灰色区域。</p>
</li>
</ul>
<hr>
<p>通过合理调参和后处理，KNN背景减除器能有效分割视频中的前景目标，适用于复杂动态环境下的移动物体检测。</p>

    </div>

    
    
    
        <div class="reward-container">
  <div>感谢老板支持！敬礼(^^ゞ</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="zhang junyi WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="zhang junyi Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/OpenCV/" rel="tag"># OpenCV</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/02/23/notebook/OpenCV/opencv_3_%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/2025-02-23--%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B003/" rel="prev" title="常用函数">
      <i class="fa fa-chevron-left"></i> 常用函数
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/02/23/notebook/OpenCV/opencv_2_%E5%B8%B8%E7%94%A8%E7%B1%BB/2025-02-23--BackgroundSubtractorMOG2/" rel="next" title="cv::BackgroundSubtractorMOG2">
      cv::BackgroundSubtractorMOG2 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">详细解释高斯混合模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-GMM-%E7%9A%84%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="nav-number">2.1.</span> <span class="nav-text">1. GMM 的核心思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89"><span class="nav-number">2.2.</span> <span class="nav-text">2. 数学定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-GMM-%E5%9C%A8%E8%83%8C%E6%99%AF%E5%87%8F%E9%99%A4%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">2.3.</span> <span class="nav-text">3. GMM 在背景减除中的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-1%EF%BC%9A%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.3.1.</span> <span class="nav-text">步骤 1：初始化模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-2%EF%BC%9A%E6%9B%B4%E6%96%B0%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.3.2.</span> <span class="nav-text">步骤 2：更新模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-3%EF%BC%9A%E9%80%89%E6%8B%A9%E8%83%8C%E6%99%AF%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.3.3.</span> <span class="nav-text">步骤 3：选择背景模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-4%EF%BC%9A%E5%89%8D%E6%99%AF%E6%A3%80%E6%B5%8B"><span class="nav-number">2.3.4.</span> <span class="nav-text">步骤 4：前景检测</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E4%B8%8E%E4%BC%98%E5%8C%96"><span class="nav-number">2.4.</span> <span class="nav-text">4. 关键参数与优化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-GMM-%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-number">2.5.</span> <span class="nav-text">5. GMM 的优缺点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-number">2.5.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9"><span class="nav-number">2.5.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%88OpenCV-MOG2%EF%BC%89"><span class="nav-number">2.6.</span> <span class="nav-text">6. 代码示例（OpenCV MOG2）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E6%80%BB%E7%BB%93"><span class="nav-number">2.7.</span> <span class="nav-text">7. 总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenCV-%E5%89%8D%E6%99%AF%E5%88%86%E5%89%B2"><span class="nav-number">3.</span> <span class="nav-text">OpenCV 前景分割</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%83%8C%E6%99%AF%E5%87%8F%E9%99%A4%EF%BC%88Background-Subtraction%EF%BC%89"><span class="nav-number">3.1.</span> <span class="nav-text">1. 背景减除（Background Subtraction）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%88MOG2%E7%AE%97%E6%B3%95%EF%BC%89"><span class="nav-number">3.1.1.</span> <span class="nav-text">代码示例（MOG2算法）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-GrabCut-%E7%AE%97%E6%B3%95"><span class="nav-number">3.2.</span> <span class="nav-text">2. GrabCut 算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.2.1.</span> <span class="nav-text">代码示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B%EF%BC%88%E5%A6%82Mask-R-CNN%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">3. 深度学习模型（如Mask R-CNN）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%88%E4%BD%BF%E7%94%A8%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%EF%BC%89"><span class="nav-number">3.3.1.</span> <span class="nav-text">代码示例（使用预训练模型）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="nav-number">3.4.</span> <span class="nav-text">4. 其他方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">3.5.</span> <span class="nav-text">注意事项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenCV-%E5%89%8D%E6%99%AF%E5%88%86%E5%89%B2-KNN%E6%96%B9%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">OpenCV 前景分割 KNN方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-KNN%E8%83%8C%E6%99%AF%E5%87%8F%E9%99%A4%E5%99%A8%E5%8E%9F%E7%90%86"><span class="nav-number">4.1.</span> <span class="nav-text">1. KNN背景减除器原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-OpenCV%E4%B8%AD%E7%9A%84KNN%E8%83%8C%E6%99%AF%E5%87%8F%E9%99%A4%E5%99%A8"><span class="nav-number">4.2.</span> <span class="nav-text">2. OpenCV中的KNN背景减除器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E5%88%9B%E5%BB%BAKNN%E8%83%8C%E6%99%AF%E5%87%8F%E9%99%A4%E5%99%A8"><span class="nav-number">4.2.1.</span> <span class="nav-text">2.1 创建KNN背景减除器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="nav-number">4.2.2.</span> <span class="nav-text">2.2 关键参数解析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.3.</span> <span class="nav-text">3. 完整代码示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%BB%93%E6%9E%9C%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="nav-number">4.4.</span> <span class="nav-text">4. 结果优化技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E5%BD%A2%E6%80%81%E5%AD%A6%E6%BB%A4%E6%B3%A2"><span class="nav-number">4.4.1.</span> <span class="nav-text">4.1 形态学滤波</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-%E9%98%B4%E5%BD%B1%E5%A4%84%E7%90%86"><span class="nav-number">4.4.2.</span> <span class="nav-text">4.2 阴影处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-%E5%8F%82%E6%95%B0%E8%B0%83%E4%BC%98"><span class="nav-number">4.4.3.</span> <span class="nav-text">4.3 参数调优</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%AF%B9%E6%AF%94KNN%E4%B8%8EMOG2"><span class="nav-number">4.5.</span> <span class="nav-text">5. 对比KNN与MOG2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="nav-number">4.6.</span> <span class="nav-text">6. 实际应用建议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="nav-number">4.7.</span> <span class="nav-text">7. 常见问题解决</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zhang junyi</p>
  <div class="site-description" itemprop="description">工作学习笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">686</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">99</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/junyiha" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;junyiha" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://x.com/zhangjunyiha" title="Twitter → https:&#x2F;&#x2F;x.com&#x2F;zhangjunyiha" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhang junyi</span>
</div>

<!--
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
